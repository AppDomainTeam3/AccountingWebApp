{% extends 'base.html' %}

  {%block title%} {{title}} {%endblock%}

    {%block content%}

      <div class= "container float-left">
        <h1 class="pt-2">{{ userData.username }}'s Profile</h1> 
        {% if canEdit %}
          <a href="{{ url }}/users/{{ userData.id }}/edit">Edit Profile</a></p>
        {% endif %}
        <div id='profileAvatar'>
          <img src={{ userData.avatarlink }} height="240">  
        </div>
        {% if userData.isActive.lower() == 'true' %}
          <p>Status: Active</p>
        {% elif userData.isActive.lower() == 'false' %}
          <p>Status: Inactive until {{ userData.reactivateUserDate }}</p>
        {% endif %}
        <p>{{ userData.firstname }} {{ userData.lastname }} <span> </span><a href="/user-mail"><i class="fas fa-envelope"></i></a></p>
        <p>{{ userData.email }}</p>
        <p>{{ userData.usertype }}</p>
        <p>Accounts:</p>
        {% for account in accounts %}
          <p id="{{ account.AccountNumber }}">{{ account.AccountName }}: {{ "Active" if account.IsActive == "True" else "Deactivated" }}
            {% if canEdit %}
            <button id="{{ account.AccountNumber }}" onclick="ToggleAccountStatus('{{ account.AccountNumber }}')">{{ "Deactivate" if account.IsActive == "True" else "Activate" }}</button>
            {% endif %}
          </p>
        {% endfor %}
      </div>
      <script type=text/javascript src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
      <script>
        function ToggleAccountStatus(accountNumber) {
          fetch('{{ api }}/accounts/' + accountNumber + '/toggle', { method: 'POST' });
          alert('Account ' + accountNumber + ' status changed!')
          window.location.href = "{{ url }}/users/{{ userData.id }}";
        }
      </script>

    {%endblock%}